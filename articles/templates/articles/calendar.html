{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="/static/css/calendar.css">
{% endblock css %}

{% block content %}
<div style="height:100vh; padding-top:2rem;">
    <div class="box" style="width:80vw; margin: auto; border:none; background-color:rgb(239, 239, 239, 0.8); box-shadow:5px 5px 30px 5px #363062;">
        {% if user.is_authenticated %}
            <h3 class="mt-3 title_is_user d-flex justify-content-center align-items-center"><b><span style="font-weight:bold;">{{ user.fullname }}</span>ë‹˜ì˜ ë‹¤ì´ì–´ë¦¬ğŸµ</b></h3>
        {% else %}
            <h3 class="mt-3 title_not_user d-flex justify-content-center"><a class="title_not_user_link" href="{% url 'accounts:login' %}">ë¡œê·¸ì¸ í•´ ì£¼ì„¸ìš”!</a></h3>
        {% endif %}
        
        
        <table id="calendar" class="d-flex justify-content-center">
            <tr><!-- labelì€ ë§ˆìš°ìŠ¤ë¡œ í´ë¦­ì„ í¸í•˜ê²Œ í•´ì¤Œ -->
                <td><label onclick="prevCalendar()" style="font-weight:bold;"><img class="direction" src="{% static 'images/back-arrow.png' %}" alt="" style="width: 20px; height: 17px;"></label></td>
                <td id="tbCalendarYM" colspan="5" style="font-weight:bold;">yyyyë…„ mì›”</td>
                <td><label onclick="nextCalendar()" style="font-weight:bold;"><img class="direction" src="{% static 'images/forward-arrow.png' %}" alt="" style="width: 20px; height: 17px;"></label></td>
            </tr>
            <tr>
                <td style="color: #F79DC2;">ì¼</td>
                <td>ì›”</td>
                <td>í™”</td>
                <td>ìˆ˜</td>
                <td>ëª©</td>
                <td>ê¸ˆ</td>
                <td style="color: skyblue;">í† </td>
            </tr> 
        </table>
    </div>
</div>

<script type="text/javascript">
        var today = new Date();//ì˜¤ëŠ˜ ë‚ ì§œ//ë‚´ ì»´í“¨í„° ë¡œì»¬ì„ ê¸°ì¤€ìœ¼ë¡œ todayì— Date ê°ì²´ë¥¼ ë„£ì–´ì¤Œ
        var date = new Date();//todayì˜ Dateë¥¼ ì„¸ì–´ì£¼ëŠ” ì—­í• 
        function prevCalendar() {//ì´ì „ ë‹¬
        // ì´ì „ ë‹¬ì„ todayì— ê°’ì„ ì €ì¥í•˜ê³  ë‹¬ë ¥ì— todayë¥¼ ë„£ì–´ì¤Œ
        //today.getFullYear() í˜„ì¬ ë…„ë„//today.getMonth() ì›”  //today.getDate() ì¼ 
        //getMonth()ëŠ” í˜„ì¬ ë‹¬ì„ ë°›ì•„ ì˜¤ë¯€ë¡œ ì´ì „ë‹¬ì„ ì¶œë ¥í•˜ë ¤ë©´ -1ì„ í•´ì¤˜ì•¼í•¨
        today = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
         buildCalendar(); //ë‹¬ë ¥ cell ë§Œë“¤ì–´ ì¶œë ¥ 
        }
        
        function nextCalendar() {//ë‹¤ìŒ ë‹¬
            // ë‹¤ìŒ ë‹¬ì„ todayì— ê°’ì„ ì €ì¥í•˜ê³  ë‹¬ë ¥ì— today ë„£ì–´ì¤Œ
            //today.getFullYear() í˜„ì¬ ë…„ë„//today.getMonth() ì›”  //today.getDate() ì¼ 
            //getMonth()ëŠ” í˜„ì¬ ë‹¬ì„ ë°›ì•„ ì˜¤ë¯€ë¡œ ë‹¤ìŒë‹¬ì„ ì¶œë ¥í•˜ë ¤ë©´ +1ì„ í•´ì¤˜ì•¼í•¨
            today = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate());
            buildCalendar();//ë‹¬ë ¥ cell ë§Œë“¤ì–´ ì¶œë ¥
        }
        function buildCalendar(){//í˜„ì¬ ë‹¬ ë‹¬ë ¥ ë§Œë“¤ê¸°
            var doMonth = new Date(today.getFullYear(),today.getMonth(),1);
            //ì´ë²ˆ ë‹¬ì˜ ì²«ì§¸ ë‚ ,
            //newë¥¼ ì“°ëŠ” ì´ìœ  : newë¥¼ ì“°ë©´ ì´ë²ˆë‹¬ì˜ ë¡œì»¬ ì›”ì„ ì •í™•í•˜ê²Œ ë°›ì•„ì˜¨ë‹¤.     
            //newë¥¼ ì“°ì§€ ì•Šì•˜ì„ë•Œ ì´ë²ˆë‹¬ì„ ë°›ì•„ì˜¤ë ¤ë©´ +1ì„ í•´ì¤˜ì•¼í•œë‹¤. 
            //ì™œëƒë©´ getMonth()ëŠ” 0~11ì„ ë°˜í™˜í•˜ê¸° ë•Œë¬¸
            var lastDate = new Date(today.getFullYear(),today.getMonth()+1,0);
            //ì´ë²ˆ ë‹¬ì˜ ë§ˆì§€ë§‰ ë‚ 
            //newë¥¼ ì¨ì£¼ë©´ ì •í™•í•œ ì›”ì„ ê°€ì ¸ì˜´, getMonth()+1ì„ í•´ì£¼ë©´ ë‹¤ìŒë‹¬ë¡œ ë„˜ì–´ê°€ëŠ”ë°
            //dayë¥¼ 1ë¶€í„° ì‹œì‘í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ 0ë¶€í„° ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— 
            //ëŒ€ë¡œ ëœ ë‹¤ìŒë‹¬ ì‹œì‘ì¼(1ì¼)ì€ ëª»ê°€ì ¸ì˜¤ê³  1 ì „ì¸ 0, ì¦‰ ì „ë‹¬ ë§ˆì§€ë§‰ì¼ ì„ ê°€ì ¸ì˜¤ê²Œ ëœë‹¤
            var tbCalendar = document.getElementById("calendar");
            //ë‚ ì§œë¥¼ ì°ì„ í…Œì´ë¸” ë³€ìˆ˜ ë§Œë“¬, ì¼ ê¹Œì§€ ë‹¤ ì°í˜
            var tbCalendarYM = document.getElementById("tbCalendarYM");
            //í…Œì´ë¸”ì— ì •í™•í•œ ë‚ ì§œ ì°ëŠ” ë³€ìˆ˜
            //innerHTML : js ì–¸ì–´ë¥¼ HTMLì˜ ê¶Œì¥ í‘œì¤€ ì–¸ì–´ë¡œ ë°”ê¾¼ë‹¤
            //newë¥¼ ì°ì§€ ì•Šì•„ì„œ monthëŠ” +1ì„ ë”í•´ì¤˜ì•¼ í•œë‹¤. 
            tbCalendarYM.innerHTML = today.getFullYear() + "ë…„ " + (today.getMonth() + 1) + "ì›”"; 

            /*whileì€ ì´ë²ˆë‹¬ì´ ëë‚˜ë©´ ë‹¤ìŒë‹¬ë¡œ ë„˜ê²¨ì£¼ëŠ” ì—­í• */
            while (tbCalendar.rows.length > 2) {
            //ì—´ì„ ì§€ì›Œì¤Œ
            //ê¸°ë³¸ ì—´ í¬ê¸°ëŠ” body ë¶€ë¶„ì—ì„œ 2ë¡œ ê³ ì •ë˜ì–´ ìˆë‹¤.
                tbCalendar.deleteRow(tbCalendar.rows.length-1);
                //í…Œì´ë¸”ì˜ tr ê°¯ìˆ˜ ë§Œí¼ì˜ ì—´ ë¬¶ìŒì€ -1ì¹¸ í•´ì¤˜ì•¼ì§€ 
                //30ì¼ ì´í›„ë¡œ ë‹´ì„ë‹¬ì— ìˆœì„œëŒ€ë¡œ ì—´ì´ ê³„ì† ì´ì–´ì§„ë‹¤.
            }
            var row = null;
            row = tbCalendar.insertRow();
             //í…Œì´ë¸”ì— ìƒˆë¡œìš´ ì—´ ì‚½ì…//ì¦‰, ì´ˆê¸°í™”
            var cnt = 0;// count, ì…€ì˜ ê°¯ìˆ˜ë¥¼ ì„¸ì–´ì£¼ëŠ” ì—­í• 
            // 1ì¼ì´ ì‹œì‘ë˜ëŠ” ì¹¸ì„ ë§ì¶”ì–´ ì¤Œ
            for (i=0; i<doMonth.getDay(); i++) {
            /*ì´ë²ˆë‹¬ì˜ dayë§Œí¼ ëŒë¦¼*/
                cell = row.insertCell();//ì—´ í•œì¹¸í•œì¹¸ ê³„ì† ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• 
                cnt = cnt + 1;//ì—´ì˜ ê°¯ìˆ˜ë¥¼ ê³„ì† ë‹¤ìŒìœ¼ë¡œ ìœ„ì¹˜í•˜ê²Œ í•´ì£¼ëŠ” ì—­í• 
            }
            /*ë‹¬ë ¥ ì¶œë ¥*/
            for (i=1; i<=lastDate.getDate(); i++) { 
             //1ì¼ë¶€í„° ë§ˆì§€ë§‰ ì¼ê¹Œì§€ ëŒë¦¼
                cell = row.insertCell();//ì—´ í•œì¹¸í•œì¹¸ ê³„ì† ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• 
                cell.innerHTML = i;//ì…€ì„ 1ë¶€í„° ë§ˆì§€ë§‰ dayê¹Œì§€ HTML ë¬¸ë²•ì— ë„£ì–´ì¤Œ
                cnt = cnt + 1;//ì—´ì˜ ê°¯ìˆ˜ë¥¼ ê³„ì† ë‹¤ìŒìœ¼ë¡œ ìœ„ì¹˜í•˜ê²Œ í•´ì£¼ëŠ” ì—­í• 
            if (cnt % 7 == 1) {/*ì¼ìš”ì¼ ê³„ì‚°*/
                  //1ì£¼ì¼ì´ 7ì¼ ì´ë¯€ë¡œ ì¼ìš”ì¼ êµ¬í•˜ê¸°
                  //ì›”í™”ìˆ˜ëª©ê¸ˆí† ì¼ì„ 7ë¡œ ë‚˜ëˆ´ì„ë•Œ ë‚˜ë¨¸ì§€ê°€ 1ì´ë©´ cntê°€ 1ë²ˆì§¸ì— ìœ„ì¹˜í•¨ì„ ì˜ë¯¸í•œë‹¤
                cell.innerHTML = "<font color=#F79DC2>" + i
                //1ë²ˆì§¸ì˜ cellì—ë§Œ ìƒ‰ì¹ 
            }    
            if (cnt%7 == 0){/* 1ì£¼ì¼ì´ 7ì¼ ì´ë¯€ë¡œ í† ìš”ì¼ êµ¬í•˜ê¸°*/
                //ì›”í™”ìˆ˜ëª©ê¸ˆí† ì¼ì„ 7ë¡œ ë‚˜ëˆ´ì„ë•Œ ë‚˜ë¨¸ì§€ê°€ 0ì´ë©´ cntê°€ 7ë²ˆì§¸ì— ìœ„ì¹˜í•¨ì„ ì˜ë¯¸í•œë‹¤
                cell.innerHTML = "<font color=skyblue>" + i
                //7ë²ˆì§¸ì˜ cellì—ë§Œ ìƒ‰ì¹ 
                row = calendar.insertRow();
                //í† ìš”ì¼ ë‹¤ìŒì— ì˜¬ ì…€ì„ ì¶”ê°€
            }
            /*ì˜¤ëŠ˜ì˜ ë‚ ì§œì— ë…¸ë€ìƒ‰ ì¹ í•˜ê¸°*/
            if (today.getFullYear() == date.getFullYear()
                && today.getMonth() == date.getMonth()
                && i == date.getDate()) {
                //ë‹¬ë ¥ì— ìˆëŠ” ë…„,ë‹¬ê³¼ ë‚´ ì»´í“¨í„°ì˜ ë¡œì»¬ ë…„,ë‹¬ì´ ê°™ê³ , ì¼ì´ ì˜¤ëŠ˜ì˜ ì¼ê³¼ ê°™ìœ¼ë©´
            cell.bgColor = "#9B96BA";//ì…€ì˜ ë°°ê²½ìƒ‰ 
            }
            }
        }
        
</script>
<script language="javascript" type="text/javascript">
    buildCalendar();
</script>

<div style="height:8rem;"></div>

{% endblock content %}